<template>
  <a-card title="审核记录" style="margin: 15px;">
    <approve-list :history-datas="historyDatas"></approve-list>
  </a-card>
</template>

<script>
import { getApprovalHistory } from '@/api/hot-work'
import ApproveList from '../component/ApproveList'
export default {
  name: 'Approval',
  components: { ApproveList },
  props: {
    ticketId: {
      type: String,
      default: '',
      required: true
    }
  },
  data () {
    return {
      historyDatas: []
    }
  },
  methods: {
    getHistory () {
      const statusMap = { 0: '审批通过', 1: '驳回',	2: '提交' }
      this.getById('/spang-safety/approve-history/approve-his', this.ticketId).then(({ data, code }) => {
        if (code === 200) {
          this.historyDatas = data.map(item => (
            {
              userTypeName: item.userTypeName,
              suggest: item.suggest,
              submitter: item.userName,
              operateName: statusMap[item.operateStatus],
              submitTime: item.submitTime,
              signature: item.signatureUrl ? this.BASE_URL + '/spang-safety/file' + item.signatureUrl : '',
              operateStatus: item.operateStatus
            }
          ))
        }
      })
    }
  },
  created () {
    this.getHistory()
  }
}
</script>

<style scoped lang="less">

  .ant-list-item {
    width: 100%;
    .list-content {
      width: 100%;
      display: flex;
      justify-content: space-between;
      .list-content-item {
        width: 15%;
      }
    }
  }
</style>
