<template>
  <a-card style="margin: 15px;">
    <div class="measure-title">整体验收时间:{{ finalData.acceptTime }}</div>
    <a-divider/>
    <a-row>
      <template v-for="(item, index) in workTypeOptions">
        <a-col :span="8" :key="index" class="line-height-md">
          <a-checkbox v-model="item.checked" disabled></a-checkbox>
          <span class="mx-5">{{ item.label }}</span>
        </a-col>
      </template>
    </a-row>
    <horizontal-list :list-data="finalData"></horizontal-list>
  </a-card>
</template>

<script>
import HorizontalList from '../component/HorizontalList'
export default {
  name: 'Inspection',
  components: { HorizontalList },
  props: {
    ticketId: {
      type: String,
      required: true
    }
  },
  data () {
    return {
      finalData: {
        title1: '作业单位作业负责人',
        title2: '所在单位监护人'
      },
      workTypeOptions: [
        {
          label: '盲板已堵',
          value: '0',
          checked: false
        }, {
          label: '盲板已抽',
          value: '1',
          checked: false
        }, {
          label: '现场已清理、确认完好',
          value: '2',
          checked: false
        }
      ]
    }
  },
  methods: {
    getHistory () {
      const params = {
        ticketId: this.ticketId,
        acceptType: 0
      }
      this.getList('/spang-safety/accept', params).then(({ data, code }) => {
        this.finalData = Object.assign({}, this.finalData, {
          time1: data.safeWorkTeachDate,
          sign1: data.safeWorkTeachPicUrl,
          files1: data.safeWorkTeachFiles,
          time2: data.safeInTeachDate,
          sign2: data.safeInTeachPicUrl,
          files2: data.safeInTeachFiles,
          acceptTime: data.finalTime
        })
        this.workTypeOptions.forEach(item => {
          const types = data.type.split(',')
          item.checked = types.includes(item.value)
        })
      })
    }
  },
  created () {
    this.getHistory()
  }
}
</script>

<style scoped>
  .mx-5 {
    margin-left: 5px;
    margin-right: 5px;
  }
  .line-height-md {
    line-height: 28px;
  }
</style>
