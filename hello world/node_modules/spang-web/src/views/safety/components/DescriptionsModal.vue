<template>
  <a-modal
    :title="title"
    :bodyStyle="{maxHeight:'600px',overflow:'auto'}"
    :width="700"
    :visible="visible"
    :closable="true"
    @cancel="() => { $emit('update:visible', false) }"
    :maskClosable="false"
    :keyboard="false"
  >
    <template slot="footer">
      <a-button @click="() => { $emit('update:visible', false) }">取消</a-button>
    </template>
    <slot name="basicInfo-head"></slot>
    <a-card :bordered="false">
      <a-descriptions :column="column" :colon="true">
        <template v-for="(item, index) in descriptions">
          <template v-if="item.type === 'input'">
            <a-descriptions-item :key="index" :label="item.label">{{ item.value || '-' }}</a-descriptions-item>
          </template>
          <template v-else-if="item.type === 'file'">
            <a-descriptions-item :label="item.label" :key="index">
              <template v-if="item.value && item.value.length > 0">
                <a-button
                  type="link"
                  size="small"
                  @click="fileDownLoad(file.id, file.originalFileName)"
                  :disabled="file.originalFileName===''"
                  v-for="file in item.value"
                  :key="file.id"
                >
                  {{ file.originalFileName }}
                </a-button>
              </template>
              <template v-else>
                {{ '-' }}
              </template>
            </a-descriptions-item>
          </template>
          <template v-else>
            <a-descriptions-item :key="index" :label="item.label">{{ item.value || '-' }}</a-descriptions-item>
          </template>
        </template>
      </a-descriptions>
    </a-card>
    <slot name="extra-content"></slot>
  </a-modal>
</template>

<script>
  import { downloadFile } from '@/api/common'
  export default {
    name: 'DescriptionsModal',
    props: {
      visible: {
        type: Boolean,
        default: false,
        required: true
      },
      records: {
        type: Array,
        default: () => [],
        required: true
      },
      title: {
        type: String,
        default: '查看数据',
        required: false
      },
      column: {
        type: Number,
        default: 1,
        required: false
      }
    },
    data () {
      return {
        descriptions: []
      }
    },
    watch: {
      records: {
        handler: function (datas) {
          this.descriptions = datas
        },
        deep: true
      }
    },
    methods: {
      fileDownLoad (id, name) {
        downloadFile(id, name)
      }
    }
  }
</script>

<style lang="less" scoped>
/deep/ .ant-card-head-title {
  font-weight: bolder;
}
/deep/ .ant-descriptions-item-label {
  //width: 150px;
  font-size: 15px;
  margin-right: 5px;
  //font-weight: bolder;
  text-align: right;
  flex: 3;
}
/deep/ .ant-descriptions-item-content {
  font-size: 15px;
  font-weight: normal!important;
  word-break: break-all;
  flex:9;
}
/deep/.ant-descriptions-item {
  display: flex;
}
</style>
