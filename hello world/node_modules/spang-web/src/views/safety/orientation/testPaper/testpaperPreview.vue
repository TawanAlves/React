<template>
  <div>
    <a-modal
      :title="modalTitle"
      :width="900"
      :visible="visible"
      :confirmLoading="loading"
      @cancel="modalCancel()"
      :keyboard="false"
      :maskClosable="false"
    >
      <template slot="footer">
        <a-button @click="modalCancel()">取消</a-button>
      </template>
      <a-spin :spinning="loading">
        <div class="testpaper-body">
          <div class="testpaper-title">{{ paperName }}</div>
          <div class="testpaper-attention">注意事项：{{ remark }}</div>
          <div class="testpaper-positions">
            <!-- 单选 -->
            <div v-if="singleChoice.questionList.length > 0" class="testpaper-positions-item">
              <div class="item-type">
                <div class="item-type-contet">单选题</div>
                <div class="item-type-code">每题{{ singleChoice.score }}分</div>
              </div>
              <div
                class="item-content"
                v-for="(item, index) in singleChoice.questionList"
                :key="'singleChoice' + index"
              >
                <div>{{ index + 1 + '.' + item.questionContent }}</div>

                <template>
                  <a-radio-group v-model="singleChoiceValue[index]" :default-value="singleChoiceValue">
                    <div
                      class="slectlist-item"
                      v-for="(itemk, k) in item.answerList"
                      :key="'singleChoiceanswerList' + k"
                    >
                      <a-radio :value="k">
                        {{ optionList[k] + '.' + itemk.content }}
                      </a-radio>
                    </div>
                  </a-radio-group>
                </template>
              </div>
            </div>
            <!-- 多选 Multiple choice -->
            <div v-if="multipleChoice.questionList.length > 0" class="testpaper-positions-item">
              <div class="item-type">
                <div class="item-type-contet">多选题</div>
                <div class="item-type-code">每题{{ multipleChoice.score }}分</div>
              </div>
              <div
                class="item-content"
                v-for="(item, index) in multipleChoice.questionList"
                :key="'multipleChoice' + index"
              >
                <div>{{ index + 1 + '.' + item.questionContent }}</div>

                <template>
                  <a-checkbox-group v-model="multipleChoiceValue[index]" :default-value="multipleChoiceValue">
                    <div
                      class="slectlist-item"
                      v-for="(itemk, k) in item.answerList"
                      :key="'multipleChoiceanswerList' + k"
                    >
                      <a-checkbox :value="k"> {{ optionList[k] + '.' + itemk.content }} </a-checkbox>
                    </div>
                  </a-checkbox-group>
                </template>
              </div>
            </div>
            <!-- 判断  judge -->
            <div v-if="judgeQuestion.questionList.length > 0" class="testpaper-positions-item">
              <div class="item-type">
                <div class="item-type-contet">判断题</div>
                <div class="item-type-code">每题{{ judgeQuestion.score }}分</div>
              </div>
              <div
                class="item-content"
                v-for="(item, index) in judgeQuestion.questionList"
                :key="'judgeQuestion' + index"
              >
                <template>
                  <div>{{ index + 1 + '.' + item.questionContent }}</div>
                  <a-radio-group v-model="judgeValue[index]" :default-value="judgeValue">
                    <div
                      class="slectlist-item"
                      v-for="(itemk, k) in item.answerList"
                      :key="'judgeQuestionanswerList' + k"
                    >
                      <a-radio :value="k">
                        {{ itemk.content }}
                      </a-radio>
                    </div>
                  </a-radio-group>
                </template>
              </div>
            </div>
          </div>
        </div>
      </a-spin>
    </a-modal>
  </div>
</template>

<script>
export default {
  name: 'testpaperPreview',
  components: {},
  props: {
    modalTitle: {
      type: String,
      default: '操作',
    },
    visible: {
      type: Boolean,
      required: true,
    },
    loading: {
      type: Boolean,
      default: () => false,
    },
    questionAnsVisit: {
      type: Object,
      default: () => null,
    },
  },
  computed: {},
  data() {
    return {
      paperName: '',
      remark: '',
      optionList: [
        'A',
        'B',
        'C',
        'D',
        'E',
        'F',
        'G',
        'H',
        'I',
        'J',
        'K',
        'L',
        'M',
        'N',
        'O',
        'P',
        'Q',
        'R',
        'S',
        'T',
        'U',
        'V',
        'W',
        'X',
        'Y',
        'Z',
      ],
      singleChoiceValue: [],
      multipleChoiceValue: [],
      judgeValue: [],

      singleChoice: { score: '', questionList: [] },
      multipleChoice: { score: '', questionList: [] },
      judgeQuestion: { score: '', questionList: [] },
    }
  },
  created() {},

  watch: {
    visible: {
      //监听的对象
      deep: true, //深度监听设置为 true
      handler: function (newV, oldV) {
        this.setQuestionList(this.questionAnsVisit)
      },
    },
  },
  mounted() {},
  methods: {
    setQuestionList(questionAnsVisit) {
      let { paperName, remark, singleChoiceScore, multipleChoiceScore, judgeNumberScore, questionAnsVoList } =
        questionAnsVisit
      this.paperName = paperName
      this.remark = remark
      let list = JSON.parse(JSON.stringify(questionAnsVoList))
      //  题型 0单选1多选2判断3填空
      let singleChoice = []
      let multipleChoice = []
      let judgeQuestion = []
      list.forEach((element) => {
        let { questionType } = element
        switch (questionType) {
          case 0:
            singleChoice.push(element)
            break
          case 1:
            multipleChoice.push(element)
            break
          case 2:
            judgeQuestion.push(element)
            break
          default:
            break
        }
      })
      this.singleChoice.score = singleChoiceScore
      this.singleChoice.questionList = singleChoice
      this.multipleChoice.score = multipleChoiceScore
      this.multipleChoice.questionList = multipleChoice
      this.judgeQuestion.score = judgeNumberScore
      this.judgeQuestion.questionList = judgeQuestion
    },
    modalOk() {
      this.singleChoiceValue = []
      this.multipleChoiceValue = []
      this.judgeValue = []
      this.$emit('ok')
    },
    modalCancel() {
      this.singleChoiceValue = []
      this.multipleChoiceValue = []
      this.judgeValue = []
      this.$emit('cancel')
    },
  },
}
</script>
<style lang="less" scoped>
.testpaper-body {
  width: 100%;
  height: 600px;
  overflow-y: auto;
  overflow-x: hidden;
  .testpaper-title {
    text-align: center;
    font-size: 30px;
    font-weight: bolder;
  }
  .testpaper-attention {
    margin: 5px 0;
  }
  .testpaper-positions {
    display: flex;
    flex-direction: column;

    .testpaper-positions-item {
      display: flex;
      flex-direction: column;
      .item-type {
        display: flex;
        flex-direction: row;
        align-items: center;
        .item-type-contet {
          font-size: 16px;
          font-weight: bolder;
        }
        .item-type-code {
          margin-left: 30px;
          font-size: 14px;
        }
      }
      .item-content {
        margin-left: 100px;
        display: flex;
        flex-direction: column;
      }
      .slectlist-item {
        display: flex;
        flex-direction: row;
        align-items: center;
        margin-top: 10px;
        margin-bottom: 10px;
      }
    }
  }
}
</style>
