<template>
  <page-container :title="false">
    <a-card :bordered="false" style="margin: 15px;"  :body-style="{paddingTop: '0px'}">
      <a-card
        :bordered="false"
        :tabList="tabList"
        :activeTabKey="tabKey"
        @tabChange="key => tabChange(key, 'tabKey')"
      >
      </a-card>
      <div v-if="tabKey === 'tab1'">
        <important />
      </div>
      <div v-else-if="tabKey === 'tab2'">
        <relation-graph :id="id" :detailType="detailType"/>
      </div>
<!--      <div v-else-if="tabKey === 'tab7'">-->
<!--        <company-info />-->
<!--      </div>-->
      <div v-else-if="tabKey === 'tab3'">
        <alarm/>
      </div>
      <div v-else-if="tabKey === 'tab4'">
        <realtime-status/>
      </div>
      <!--    <div v-else-if="tabKey === 'tab5'">-->
      <!--      <iframe src="https://datav.aliyuncs.com/share/0cceb65a3548f9be9bae84e075bdc4c7" style="min-height:912px;min-width: 100%" frameborder="0">-->
      <!--      </iframe>-->
      <!--    </div>-->
      <div v-else-if="tabKey==='tab6'">
        <announcement/>
      </div>
    </a-card>
  </page-container>
</template>

<script>
import Important from './Important'
import Statistic from './Statistic'
import RelationGraph from '@/views/safety/important/RelationGraph'
import Alarm from '@/views/safety/important/Alarm'
import RealtimeStatus from '@/views/safety/important/RealtimeStatus'
import Announcement from '@/views/safety/important/Announcement'
import CompanyInfo from './CompanyInfo'
export default {
  components: {
    Important,
    Statistic,
    RelationGraph,
    Alarm,
    RealtimeStatus,
    Announcement,
    CompanyInfo
  },
  data () {
    return {
      id: null,
      detailType: 3,
      tabList: [
        {
          key: 'tab1',
          tab: '两重点一重大'
        },
        {
          key: 'tab2',
          tab: '关系图谱'
        }
        // {
        //   key: 'tab7',
        //   tab: '企业信息维护'
        // }
        // {
        //   key: 'tab3',
        //   tab: '报警事件'
        // },
        // {
        //   key: 'tab4',
        //   tab: '实时状态'
        // },
        // {
        //   key: 'tab5',
        //   tab: '统计分析'
        // },
        // {
        //   key: 'tab6',
        //   tab: '安全承诺报告'
        // }
      ],
      tabKey: 'tab1'
    }
  },
  mounted () {
    // window.addEventListener('message', this.handleMessage)
  },
  destroyed () {
    // window.removeEventListener('message', this.handleMessage)
  },
  methods: {
    handleMessage (e) {
      if (e.data) {
        console.log(e.data)
        // this.tabKey = 'tab2'
        this.id = e.data.id
        this.detailType = e.data.type

        // self.$router.push({
          //   name: 'organizations',
          //   params: {
          //     id: '1111111111'
          //   }
          // })
      }
    },
    tabChange (key, type) {
      this[type] = key
    }
  }
}
</script>
