<template>
  <a-modal
    :title="modalTitle"
    width="50%"
    :visible="visible"
    :confirmLoading="loading"
    @ok="() => { $emit('ok') }"
    @cancel="() => { $emit('cancel') }"
    ok-text="确定"
    cancel-text="取消"
  >
    <a-spin :spinning="loading">
      <a-form :form="form">
        <a-row :gutter="24">
          <a-col :md="24">
            <a-form-item label="机构名称">
              <a-input v-decorator="['company',{ rules:[{ required: true, message: '请输入机构名称' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="专家姓名">
              <a-input v-decorator="['name',{ rules:[{ required: true, message: '请输入物资名称' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
          <a-col :md="12">
            <a-form-item label="性别">
              <a-radio-group :options="options" v-decorator="['sex',{ rules:[{ required: true }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="出生日期">
              <a-date-picker style="min-width: 100%" v-decorator="['birthday',{ rules:[{ required: false }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
          <a-col :md="12">
            <a-form-item label="学历">
              <a-select v-decorator="['degree',{ rules:[{ required: false, message: '请选择学历' }]}]" :disabled="disabled">
                <a-select-option v-for="d in degreeOptions" :key="d.value">
                  {{ d.text }}
                </a-select-option>
              </a-select>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="手机号码">
              <a-input v-decorator="['mobile',{ rules:[{ required: false, message: '请输入手机号' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
          <a-col :md="12">
            <a-form-item label="职称">
              <a-input v-decorator="['title',{ rules:[{ required: false, message: '请输入职称' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="从事行业">
              <a-select v-decorator="['profession',{ rules:[{ required: false, message: '请输入从事行业' }]}]" :disabled="disabled">
                <a-select-option v-for="d in professionOptions" :key="d.value">
                  {{ d.text }}
                </a-select-option>
              </a-select>
            </a-form-item>
          </a-col>
          <a-col :md="12">
            <a-form-item label="专长领域">
              <a-input v-decorator="['expertise',{ rules:[{ required: false, message: '请输入专长领域' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="工作单位">
              <a-input v-decorator="['workplace',{ rules:[{ required: false, message: '请输入工作单位' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
          <a-col :md="12">
            <a-form-item label="工作岗位">
              <a-input v-decorator="['jobPosition',{ rules:[{ required: false, message: '请输入工作岗位' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="毕业学校">
              <a-input v-decorator="['university',{ rules:[{ required: false, message: '请输入毕业学校' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
          <a-col :md="12">
            <a-form-item label="联系地址">
              <a-input v-decorator="['address',{ rules:[{ required: false, message: '请输入联系地址' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
        <a-row :gutter="24">
          <a-col :md="12">
            <a-form-item label="电子邮件">
              <a-input v-decorator="['email',{ rules:[{ required: false, message: '请输入电子邮件' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
          <a-col :md="24">
            <a-form-item label="备注">
              <a-input v-decorator="['remark',{ rules:[{ required: false, message: '请输入备注' }]}]" :disabled="disabled"/>
            </a-form-item>
          </a-col>
        </a-row>
      </a-form>
    </a-spin>
  </a-modal>
</template>

<script>
import pick from 'lodash.pick'
import { expertsColumns } from '@/views/emergency/resources/table'

const fields = expertsColumns.map((res) => {
  return res.dataIndex
})

export default {
  name: 'ExpertsModal',
  props: {
    visible: {
      type: Boolean,
      required: true
    },
    loading: {
      type: Boolean,
      default: () => false
    },
    model: {
      type: Object,
      default: () => null
    },
    selectOptions: {
      type: Object,
      default: () => null
    },
    modalTitle: {
      type: String,
      default: '操作'
    },
    disabled: {
      type: Boolean,
      default: false
    }
  },
  data () {
    return {
      options: [
        {
          label: '男',
          value: '男'
        },
        {
          label: '女',
          value: '女'
        }
      ],
      degreeOptions: [
        {
          text: '本科',
          value: '本科'
        },
        {
          text: '硕士',
          value: '硕士'
        },
        {
          text: '博士',
          value: '博士'
        }
      ],
      professionOptions: [
        {
          text: '教育',
          value: '教育'
        },
        {
          text: 'IT',
          value: 'IT'
        },
        {
          text: '医疗',
          value: '医疗'
        }
      ],
      form: this.$form.createForm(this)
    }
  },
  created () {
    // 防止表单未注册
    fields.forEach(v => this.form.getFieldDecorator(v))
    // 当 model 发生改变时，为表单设置值
    this.$watch('model', () => {
      this.previewImage = this.model.logo
      this.model && this.form.setFieldsValue(pick(this.model, fields))
    })
  },
  methods: {
    onChange (e) {
      this.form.sex = e.target.value
    }
  }
}
</script>
